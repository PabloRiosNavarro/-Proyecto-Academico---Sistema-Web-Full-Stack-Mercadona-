{% extends "base.html" %}

{% block title %}Portada{% endblock %}

{% block content %}

<h2 class="text-xl font-semibold mb-4">
  {% if busqueda %}
    Resultados de búsqueda
  {% else %}
    Productos destacados
  {% endif %}
</h2>

<!-- Plantilla de tarjeta para clonar con JS -->
<template id="plantilla">
  <div class="card bg-white rounded shadow-sm overflow-hidden">
    <!-- Imagen -->
    <img src="" alt="Producto" class="w-full h-48 object-cover">

    <!-- Contenido -->
    <div class="p-4">
      <h5 class="font-semibold text-base mb-1" id="nombre-producto">Nombre</h5>
      <p class="text-sm text-gray-600 mb-2" id="descripcion-producto">Descripción</p>

      <p class="precio-actual text-green-600 font-semibold" data-id="" id="precio-producto"></p>
      <p class="text-gray-500 line-through text-xs hidden" id="precio-original"></p>

      <a href="#" class="inline-block mt-3 bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition">
        Añadir al carrito
      </a>


    
    </div>
  </div>
</template>

<!-- Contenedor donde se mostraran las tarjetas -->
<div id="tarjetas" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
  
  {% for p in productos %}
    <div class="card bg-white rounded shadow-sm overflow-hidden">
      <!-- Imagen -->
      <img src="{{ p.url_img }}" alt="{{ p.texto_1 }}" class="w-full h-48 object-contain">


      <!-- Contenido -->
      <div class="p-4">
        <h5 class="font-semibold text-base mb-1">{{ p.texto_1 }}</h5>
        <p class="text-sm text-gray-600 mb-2">{{ p.texto_2 }}</p>

        {% if p.precio_rebajado > 0 %}
        <p class="precio-actual text-red-600 font-bold" data-id="{{ p._id }}">
          Rebajado: {{ p.precio_rebajado }} €
          <span class="text-gray-500 line-through font-normal">{{ p.texto_precio }}</span>
        </p>
        {% else %}
        <p class="precio-actual text-green-600 font-semibold" data-id="{{ p._id }}">
          {{ p.texto_precio }}
        </p>
        {% endif %}

        <a href="/al_carrito/{{ p._id }}"
          class="inline-block mt-3 bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition">
          Añadir al carrito
        </a>
        <!-- Si el user es admin podra modificar precio y eliminar productos -->
        {% if isAdmin %}
        <div class="mt-3 flex items-center gap-1">
          <input type="number" step="0.01" value="{{ p.precio_euros }}" data-id="{{ p._id }}"
            class="precio-input flex-1 min-w-0 border rounded px-2 py-1 text-sm">
          <button class="btn-cambiar-precio bg-yellow-400 px-2 py-1 rounded text-sm hover:bg-yellow-500 transition"
            data-id="{{ p._id }}">
            Actualizar
          </button>

          <button class="btn-eliminar-producto bg-red-400 px-2 py-1 rounded text-sm hover:bg-red-500 transition"
            data-id="{{ p._id }}">
            Eliminar
          </button>
        </div>

        {% endif %}

      </div>
    </div>
  {% endfor %}
</div>  



{% endblock %}
